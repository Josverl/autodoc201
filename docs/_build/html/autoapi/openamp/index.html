<!DOCTYPE html>

<html data-content_root="../../" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>openamp — API documentation test 1 documentation</title>
<link href="../../_static/pygments.css?v=fa44fd50" rel="stylesheet" type="text/css"/>
<link href="../../_static/alabaster.css?v=12dfc556" rel="stylesheet" type="text/css"/>
<link href="../../_static/graphviz.css?v=fd3f3429" rel="stylesheet" type="text/css"/>
<script src="../../_static/documentation_options.js?v=29a6c3e3"></script>
<script src="../../_static/doctools.js?v=9a2dae69"></script>
<script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
<link href="../../genindex.html" rel="index" title="Index"/>
<link href="../../search.html" rel="search" title="Search"/>
<link href="../os/index.html" rel="next" title="os"/>
<link href="../network/WLANWiPy/index.html" rel="prev" title="network.WLANWiPy"/>
<link href="../../_static/custom.css" rel="stylesheet" type="text/css"/>
</head><body>
<div class="document">
<div class="documentwrapper">
<div class="bodywrapper">
<div class="body" role="main">
<section id="module-openamp">
<span id="openamp"></span><h1>openamp<a class="headerlink" href="#module-openamp" title="Link to this heading">¶</a></h1>
<p>Provides standard Asymmetric Multiprocessing (AMP) support.</p>
<p>MicroPython module: <a class="reference external" href="https://docs.micropython.org/en/v1.23.0/library/openamp.html">https://docs.micropython.org/en/v1.23.0/library/openamp.html</a></p>
<p>The <code class="docutils literal notranslate"><span class="pre">openamp</span></code> module provides a standard inter-processor communications infrastructure
for MicroPython. The module handles all of the details of OpenAMP, such as setting up
the shared resource table, initializing vrings, etc. It provides an API for using the
RPMsg bus infrastructure with the <a class="reference internal" href="#openamp.Endpoint" title="openamp.Endpoint"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Endpoint</span></code></a> class, and provides processor Life Cycle
Management (LCM) support, such as loading firmware and starting and stopping a remote
core, via the <a class="reference internal" href="#openamp.RemoteProc" title="openamp.RemoteProc"><code class="xref any py py-class docutils literal notranslate"><span class="pre">RemoteProc</span></code></a> class.</p>
<p>Example usage:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openamp</span>

<span class="k">def</span> <span class="nf">ept_recv_callback</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Received message on endpoint"</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

<span class="c1"># Create a new RPMsg endpoint to communicate with the remote core.</span>
<span class="n">ept</span> <span class="o">=</span> <span class="n">openamp</span><span class="o">.</span><span class="n">Endpoint</span><span class="p">(</span><span class="s2">"vuart-channel"</span><span class="p">,</span> <span class="n">callback</span><span class="o">=</span><span class="n">ept_recv_callback</span><span class="p">)</span>

<span class="c1"># Create a RemoteProc object, load its firmware and start it.</span>
<span class="n">rproc</span> <span class="o">=</span> <span class="n">openamp</span><span class="o">.</span><span class="n">RemoteProc</span><span class="p">(</span><span class="s2">"virtual_uart.elf"</span><span class="p">)</span> <span class="c1"># Or entry point address (ex 0x081E0000)</span>
<span class="n">rproc</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">ept</span><span class="o">.</span><span class="n">is_ready</span><span class="p">():</span>
        <span class="n">ept</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">"data"</span><span class="p">)</span>
</pre></div>
</div>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#openamp.Endpoint" title="openamp.Endpoint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Endpoint</span></code></a></p></td>
<td><p>Construct a new RPMsg Endpoint. An endpoint is a bidirectional communication</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#openamp.RemoteProc" title="openamp.RemoteProc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RemoteProc</span></code></a></p></td>
<td><p>The RemoteProc object provides processor Life Cycle Management (LCM) support, such as</p></td>
</tr>
</tbody>
</table>
</section>
<section id="functions">
<h2>Functions<a class="headerlink" href="#functions" title="Link to this heading">¶</a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#openamp.new_service_callback" title="openamp.new_service_callback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">new_service_callback</span></code></a>(→ None)</p></td>
<td><p>Set the new service callback.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="package-contents">
<h2>Package Contents<a class="headerlink" href="#package-contents" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="openamp.Endpoint">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">openamp.</span></span><span class="sig-name descname"><span class="pre">Endpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callback</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">ENDPOINT_ADDR_ANY</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">ENDPOINT_ADDR_ANY</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openamp.Endpoint" title="Link to this definition">¶</a></dt>
<dd><p>Construct a new RPMsg Endpoint. An endpoint is a bidirectional communication
channel between two cores.</p>
<p>Arguments are:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>name</em> is the name of the endpoint.</p></li>
<li><p><em>callback</em> is a function that is called when the endpoint receives data with the
source address of the remote point, and the data as bytes passed by reference.</p></li>
<li><p><em>src</em> is the endpoint source address. If none is provided one will be assigned
to the endpoint by the library.</p></li>
<li><p><em>dest</em> is the endpoint destination address. If the endpoint is created from the
new_service_callback, this must be provided and it must match the remote endpoint’s
source address. If the endpoint is registered locally, before the announcement, the
destination address will be assigned by the library when the endpoint is bound.</p></li>
</ul>
</div></blockquote>
<dl class="py method">
<dt class="sig sig-object py" id="openamp.Endpoint.deinit">
<span class="sig-name descname"><span class="pre">deinit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">Incomplete</span></span></span><a class="headerlink" href="#openamp.Endpoint.deinit" title="Link to this definition">¶</a></dt>
<dd><p>Destroy the endpoint and release all of its resources.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openamp.Endpoint.is_ready">
<span class="sig-name descname"><span class="pre">is_ready</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3.5/library/functions.html#bool" title="(in Python v3.5)"><span class="pre">bool</span></a></span></span><a class="headerlink" href="#openamp.Endpoint.is_ready" title="Link to this definition">¶</a></dt>
<dd><p>Returns True if the endpoint is ready to send (i.e., has both a source and destination addresses)</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openamp.Endpoint.send">
<span class="sig-name descname"><span class="pre">send</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">src</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dest</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3.5/library/constants.html#None" title="(in Python v3.5)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#openamp.Endpoint.send" title="Link to this definition">¶</a></dt>
<dd><p>Send a message to the remote processor over this endpoint.</p>
<p>Arguments are:</p>
<blockquote>
<div><ul class="simple">
<li><p><em>src</em> is the source endpoint address of the message. If none is provided, the
source address the endpoint is bound to is used.</p></li>
<li><p><em>dest</em> is the destination endpoint address of the message. If none is provided,
the destination address the endpoint is bound to is used.</p></li>
<li><p><em>timeout</em> specifies the time in milliseconds to wait for a free buffer. By default
the function is blocking.</p></li>
</ul>
</div></blockquote>
</dd></dl>
</dd></dl>
<dl class="py class">
<dt class="sig sig-object py" id="openamp.RemoteProc">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">openamp.</span></span><span class="sig-name descname"><span class="pre">RemoteProc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">entry</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#openamp.RemoteProc" title="Link to this definition">¶</a></dt>
<dd><p>The RemoteProc object provides processor Life Cycle Management (LCM) support, such as
loading firmware, starting and stopping a remote core.</p>
<p>The <em>entry</em> argument can be a path to firmware image, in which case the firmware is
loaded from file to its target memory, or an entry point address, in which case the
firmware must be loaded already at the given address.</p>
<dl class="py method">
<dt class="sig sig-object py" id="openamp.RemoteProc.shutdown">
<span class="sig-name descname"><span class="pre">shutdown</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">Incomplete</span></span></span><a class="headerlink" href="#openamp.RemoteProc.shutdown" title="Link to this definition">¶</a></dt>
<dd><p>Shutdown stops the remote processor and releases all of its resources. The exact behavior
is platform-dependent, however typically it disables power and clocks to the remote core.
This function is also used as the finaliser (i.e., called when <code class="docutils literal notranslate"><span class="pre">RemoteProc</span></code> object is
collected). Note that on the STM32H7, it’s not possible to stop and then restart the
Cortex-M4 core, so a complete system reset is performed on a call to this function.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openamp.RemoteProc.start">
<span class="sig-name descname"><span class="pre">start</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><span class="pre">Incomplete</span></span></span><a class="headerlink" href="#openamp.RemoteProc.start" title="Link to this definition">¶</a></dt>
<dd><p>Starts the remote processor.</p>
</dd></dl>
<dl class="py method">
<dt class="sig sig-object py" id="openamp.RemoteProc.stop">
<span class="sig-name descname"><span class="pre">stop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3.5/library/constants.html#None" title="(in Python v3.5)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#openamp.RemoteProc.stop" title="Link to this definition">¶</a></dt>
<dd><p>Stops the remote processor. The exact behavior is platform-dependent. On the STM32H7 for
example it’s not possible to stop and then restart the Cortex-M4 core, so a complete
system reset is performed on a call to this function.</p>
</dd></dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="openamp.new_service_callback">
<span class="sig-prename descclassname"><span class="pre">openamp.</span></span><span class="sig-name descname"><span class="pre">new_service_callback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ns_callback</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">→</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3.5/library/constants.html#None" title="(in Python v3.5)"><span class="pre">None</span></a></span></span><a class="headerlink" href="#openamp.new_service_callback" title="Link to this definition">¶</a></dt>
<dd><p>Set the new service callback.</p>
<p>The <em>ns_callback</em> argument is a function that will be called when the remote processor
announces new services. At that point the host processor can choose to create the
announced endpoint, if this particular service is supported, or ignore it if it’s
not. If this function is not set, the host processor should first register the
endpoint locally, and it will be automatically bound when the remote announces
the service.</p>
</dd></dl>
</section>
</section>
</div>
</div>
</div>
<div aria-label="main navigation" class="sphinxsidebar" role="navigation">
<div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">API documentation test</a></h1>
<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../library/index.html">LiBrary!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bar.html">bar</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">MicroPython Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../_asyncio/index.html">_asyncio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_boot/index.html">_boot</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_boot_fat/index.html">_boot_fat</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_onewire/index.html">_onewire</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_rp2/index.html">_rp2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../_thread/index.html">_thread</a></li>
<li class="toctree-l2"><a class="reference internal" href="../array/index.html">array</a></li>
<li class="toctree-l2"><a class="reference internal" href="../asyncio/index.html">asyncio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../binascii/index.html">binascii</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bluetooth/index.html">bluetooth</a></li>
<li class="toctree-l2"><a class="reference internal" href="../btree/index.html">btree</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cmath/index.html">cmath</a></li>
<li class="toctree-l2"><a class="reference internal" href="../collections/index.html">collections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cryptolib/index.html">cryptolib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deflate/index.html">deflate</a></li>
<li class="toctree-l2"><a class="reference internal" href="../errno/index.html">errno</a></li>
<li class="toctree-l2"><a class="reference internal" href="../esp/index.html">esp</a></li>
<li class="toctree-l2"><a class="reference internal" href="../esp32/index.html">esp32</a></li>
<li class="toctree-l2"><a class="reference internal" href="../espnow/index.html">espnow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../framebuf/index.html">framebuf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gc/index.html">gc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gzip/index.html">gzip</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hashlib/index.html">hashlib</a></li>
<li class="toctree-l2"><a class="reference internal" href="../heapq/index.html">heapq</a></li>
<li class="toctree-l2"><a class="reference internal" href="../io/index.html">io</a></li>
<li class="toctree-l2"><a class="reference internal" href="../json/index.html">json</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lcd160cr/index.html">lcd160cr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../machine/index.html">machine</a></li>
<li class="toctree-l2"><a class="reference internal" href="../math/index.html">math</a></li>
<li class="toctree-l2"><a class="reference internal" href="../micropython/index.html">micropython</a></li>
<li class="toctree-l2"><a class="reference internal" href="../neopixel/index.html">neopixel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../network/index.html">network</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">openamp</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#classes">Classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#functions">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#package-contents">Package Contents</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#openamp.Endpoint"><code class="docutils literal notranslate"><span class="pre">Endpoint</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="#openamp.Endpoint.deinit"><code class="docutils literal notranslate"><span class="pre">Endpoint.deinit()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#openamp.Endpoint.is_ready"><code class="docutils literal notranslate"><span class="pre">Endpoint.is_ready()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#openamp.Endpoint.send"><code class="docutils literal notranslate"><span class="pre">Endpoint.send()</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#openamp.RemoteProc"><code class="docutils literal notranslate"><span class="pre">RemoteProc</span></code></a><ul>
<li class="toctree-l5"><a class="reference internal" href="#openamp.RemoteProc.shutdown"><code class="docutils literal notranslate"><span class="pre">RemoteProc.shutdown()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#openamp.RemoteProc.start"><code class="docutils literal notranslate"><span class="pre">RemoteProc.start()</span></code></a></li>
<li class="toctree-l5"><a class="reference internal" href="#openamp.RemoteProc.stop"><code class="docutils literal notranslate"><span class="pre">RemoteProc.stop()</span></code></a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#openamp.new_service_callback"><code class="docutils literal notranslate"><span class="pre">new_service_callback()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../os/index.html">os</a></li>
<li class="toctree-l2"><a class="reference internal" href="../platform/index.html">platform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pyb/index.html">pyb</a></li>
<li class="toctree-l2"><a class="reference internal" href="../random/index.html">random</a></li>
<li class="toctree-l2"><a class="reference internal" href="../rp2/index.html">rp2</a></li>
<li class="toctree-l2"><a class="reference internal" href="../select/index.html">select</a></li>
<li class="toctree-l2"><a class="reference internal" href="../socket/index.html">socket</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ssl/index.html">ssl</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stm/index.html">stm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../struct/index.html">struct</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sys/index.html">sys</a></li>
<li class="toctree-l2"><a class="reference internal" href="../time/index.html">time</a></li>
<li class="toctree-l2"><a class="reference internal" href="../uctypes/index.html">uctypes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../vfs/index.html">vfs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../wipy/index.html">wipy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../wm8960/index.html">wm8960</a></li>
<li class="toctree-l2"><a class="reference internal" href="../zephyr/index.html">zephyr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../zlib/index.html">zlib</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
<li><a href="../../index.html">Documentation overview</a><ul>
<li><a href="../index.html">MicroPython Modules</a><ul>
<li>Previous: <a href="../network/WLANWiPy/index.html" title="previous chapter">network.WLANWiPy</a></li>
<li>Next: <a href="../os/index.html" title="next chapter">os</a></li>
</ul></li>
</ul></li>
</ul>
</div>
<search id="searchbox" role="search" style="display: none">
<h3 id="searchlabel">Quick search</h3>
<div class="searchformwrapper">
<form action="../../search.html" class="search" method="get">
<input aria-labelledby="searchlabel" autocapitalize="off" autocomplete="off" autocorrect="off" name="q" spellcheck="false" type="text"/>
<input type="submit" value="Go"/>
</form>
</div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
</div>
</div>
<div class="clearer"></div>
</div>
<div class="footer">
      ©2024, Jos Verlinde.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../../_sources/autoapi/openamp/index.rst.txt" rel="nofollow">Page source</a>
</div>
</body>
</html>